<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Solana Payment Autopilot!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <nav class="bg-white shadow-md border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-6 py-5">
            <div class="flex items-center">
                <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600">
                    ‚òÑÔ∏è Solana Payment Autopilot
                </h1>
            </div>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto px-6 py-12">
        <!-- Success Message -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
            <div class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4">
                    <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h2 class="text-3xl font-bold text-gray-900 mb-2">üéâ Welcome Aboard!</h2>
                <p class="text-lg text-gray-600">Your merchant account is ready. Start accepting crypto payments now!</p>
            </div>

            <!-- Merchant Credentials -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border-2 border-blue-200 mb-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">üìù Your Merchant Credentials</h3>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Merchant ID</label>
                        <div class="flex items-center gap-2">
                            <input 
                                type="text"
                                id="merchantId"
                                readonly
                                class="flex-1 font-mono text-sm bg-white border-2 border-gray-300 rounded-lg px-4 py-3"
                            />
                            <button 
                                onclick="copy('merchantId')"
                                class="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                            >
                                Copy
                            </button>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Payment Wallet Address</label>
                        <div class="flex items-center gap-2">
                            <input 
                                type="text"
                                id="walletAddress"
                                readonly
                                class="flex-1 font-mono text-sm bg-white border-2 border-gray-300 rounded-lg px-4 py-3"
                            />
                            <button 
                                onclick="copy('walletAddress')"
                                class="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                            >
                                Copy
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Customers send payments to this address</p>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Business Name</label>
                        <input 
                            type="text"
                            id="businessName"
                            readonly
                            class="w-full bg-white border-2 border-gray-300 rounded-lg px-4 py-3"
                        />
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
                        <input 
                            type="text"
                            id="email"
                            readonly
                            class="w-full bg-white border-2 border-gray-300 rounded-lg px-4 py-3"
                        />
                    </div>
                </div>

                <div class="mt-4 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                    <p class="text-sm text-yellow-900">
                        <strong>‚ö†Ô∏è Important:</strong> Save these credentials! We've also sent them to your email.
                    </p>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="grid md:grid-cols-2 gap-4 mb-6">
                <a 
                    id="dashboardLink"
                    href="../merchant-dashboard/index.html"
                    target="_blank"
                    class="flex items-center justify-between p-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all shadow-lg"
                >
                    <div>
                        <p class="font-semibold">üìä Merchant Dashboard</p>
                        <p class="text-sm opacity-90">View transactions & export data</p>
                    </div>
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>

                <a 
                    id="solscanLink"
                    href="#"
                    target="_blank"
                    class="flex items-center justify-between p-4 bg-white border-2 border-gray-300 rounded-xl hover:border-blue-500 transition-all"
                >
                    <div>
                        <p class="font-semibold text-gray-900">üîó View on Solscan</p>
                        <p class="text-sm text-gray-600">Check your wallet on blockchain</p>
                    </div>
                    <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Integration Guide -->
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <h3 class="text-2xl font-bold text-gray-900 mb-4">üöÄ Integration Guide</h3>
            <p class="text-gray-600 mb-6">Add crypto payments to your website in 3 simple steps:</p>

            <!-- Step 1 -->
            <div class="mb-8">
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full font-bold">1</div>
                    <h4 class="text-lg font-bold text-gray-900">Include the SDK</h4>
                </div>
                <p class="text-sm text-gray-600 mb-3">Add this script tag to your website's HTML:</p>
                <div class="code-block">
&lt;script src="https://cdn.solanaautopilot.com/sdk.js"&gt;&lt;/script&gt;
                </div>
            </div>

            <!-- Step 2 -->
            <div class="mb-8">
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full font-bold">2</div>
                    <h4 class="text-lg font-bold text-gray-900">Initialize the SDK</h4>
                </div>
                <p class="text-sm text-gray-600 mb-3">Copy and paste this code (your credentials are pre-filled):</p>
                <div class="code-block" id="sdkCode">
&lt;script&gt;
  const autopilot = new SolanaAutopilot({
    merchantId: '<span id="merchantIdCode">LOADING...</span>',
    apiBase: 'http://localhost:3000',
    onSuccess: (payment) => {
      console.log('Payment successful!', payment);
      // Grant access to product/service
    }
  });
&lt;/script&gt;
                </div>
                <button 
                    onclick="copyCode()"
                    class="mt-3 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                    </svg>
                    Copy Code
                </button>
            </div>

            <!-- Step 3 -->
            <div class="mb-6">
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center justify-center w-8 h-8 bg-blue-600 text-white rounded-full font-bold">3</div>
                    <h4 class="text-lg font-bold text-gray-900">Create Payment Button</h4>
                </div>
                <p class="text-sm text-gray-600 mb-3">Add a payment button anywhere on your site:</p>
                <div class="code-block">
&lt;button onclick="checkout()"&gt;Pay with Crypto&lt;/button&gt;

&lt;script&gt;
  async function checkout() {
    await autopilot.createPayment({
      amount: 10,  // USD amount
      orderId: 'ORDER-' + Date.now(),
      customerEmail: 'customer@example.com',
      description: 'Your Product Name'
    });
  }
&lt;/script&gt;
                </div>
            </div>

            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                <p class="text-sm text-green-900">
                    <strong>‚úÖ That's it!</strong> Payments will be detected automatically, converted to USDC, and appear in your dashboard.
                </p>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="hidden fixed bottom-6 right-6 bg-green-600 text-white px-6 py-4 rounded-lg shadow-xl flex items-center gap-3">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        <span id="toastMessage">Copied!</span>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000/api';

        // Get merchant ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const merchantId = urlParams.get('merchant_id');

        if (!merchantId) {
            alert('Invalid merchant ID');
            window.location.href = 'index.html';
        }

        // Load merchant data
        async function loadMerchantData() {
            try {
                const res = await fetch(`${API_BASE}/merchants`);
                const data = await res.json();
                
                if (data.success) {
                    const merchant = data.data.find(m => m.id === merchantId);
                    
                    if (merchant) {
                        document.getElementById('merchantId').value = merchant.id;
                        document.getElementById('walletAddress').value = merchant.wallet_address;
                        document.getElementById('businessName').value = merchant.business_name;
                        document.getElementById('email').value = merchant.email;
                        document.getElementById('merchantIdCode').textContent = merchant.id;
                        document.getElementById('solscanLink').href = `https://solscan.io/account/${merchant.wallet_address}?cluster=devnet`;
                    }
                }
            } catch (error) {
                console.error('Failed to load merchant data:', error);
            }
        }

        function copy(elementId) {
            const input = document.getElementById(elementId);
            input.select();
            navigator.clipboard.writeText(input.value);
            showToast('Copied to clipboard!');
        }

        function copyCode() {
            const code = document.getElementById('sdkCode').innerText;
            navigator.clipboard.writeText(code);
            showToast('SDK code copied!');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.classList.remove('hidden');
            
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        // Load data on page load
        window.addEventListener('DOMContentLoaded', loadMerchantData);
    </script>
</body>
</html>
